<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Pet Smart NFC Card</title>

<style>
  body{
    margin:0;
    font-family:Arial, sans-serif;
    background:radial-gradient(circle at top, #0f172a, #020617);
    color:white;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
  }
  .card{
    width:360px;
    background:#0b1220;
    border-radius:16px;
    padding:20px;
    box-shadow:0 20px 40px rgba(0,0,0,.6);
  }
  h1{text-align:center;margin:0}
  p{text-align:center;color:#94a3b8;margin:5px 0 15px}
  .row{margin:8px 0;font-size:14px}
  .label{color:#94a3b8}
  .value{font-weight:bold}
  button{
    width:100%;
    margin-top:10px;
    padding:12px;
    border:none;
    border-radius:10px;
    font-size:16px;
    cursor:pointer;
  }
  .btn-main{background:#2dd4bf;color:#022c22}
  .btn-edit{background:#020617;color:#2dd4bf;border:1px dashed #2dd4bf}
  .hidden{display:none}
  input,textarea{
    width:100%;
    padding:10px;
    margin-top:6px;
    background:#020617;
    border:1px solid #1e293b;
    color:white;
    border-radius:8px;
  }
</style>
</head>

<body>

<div class="card">
  <h1>üêæ Pet Smart NFC Card</h1>
  <p>One tap can bring me home</p>

  <!-- VIEW MODE -->
  <div id="view">
    <div class="row"><span class="label">Pet Name:</span> <span class="value" id="v_name">Loading‚Ä¶</span></div>
    <div class="row"><span class="label">Pet Type:</span> <span class="value" id="v_type"></span></div>
    <div class="row"><span class="label">Owner:</span> <span class="value" id="v_owner"></span></div>
    <div class="row"><span class="label">Mobile:</span> <span class="value" id="v_phone"></span></div>
    <div class="row"><span class="label">Pet ID:</span> <span class="value" id="v_id"></span></div>

    <button class="btn-main" onclick="callOwner()">üìû Call Owner</button>
    <button class="btn-edit" onclick="openEdit()">‚úèÔ∏è Edit Details</button>
  </div>

  <!-- EDIT MODE -->
  <div id="edit" class="hidden">
    <input id="e_name" placeholder="Pet Name">
    <input id="e_type" placeholder="Pet Type">
    <input id="e_owner" placeholder="Owner Name">
    <input id="e_phone" placeholder="Mobile Number">
    <textarea id="e_medical" placeholder="Medical Info (optional)"></textarea>
    <button class="btn-main" onclick="save()">üíæ Save</button>
    <button class="btn-edit" onclick="closeEdit()">Cancel</button>
  </div>
</div>

<!-- FIREBASE SDKs (REQUIRED) -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
/* üî• FIREBASE CONFIG ‚Äî REPLACE ONLY THIS */
const firebaseConfig = {
  apiKey: "PASTE_API_KEY",
  authDomain: "PASTE_DOMAIN",
  projectId: "PASTE_PROJECT_ID",
  appId: "PASTE_APP_ID"
};

/* INIT */
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

/* PET ID FROM URL */
const petId = new URLSearchParams(location.search).get("pet") || "PET001";

/* LOAD DATA */
async function load(){
  const ref = db.collection("pets").doc(petId);
  const snap = await ref.get();

  if(!snap.exists){
    document.getElementById("v_name").innerText = "Not registered";
    document.getElementById("v_id").innerText = petId;
    return;
  }

  const d = snap.data();
  v_name.innerText = d.name || "";
  v_type.innerText = d.type || "";
  v_owner.innerText = d.owner || "";
  v_phone.innerText = d.phone || "";
  v_id.innerText = petId;

  e_name.value = d.name || "";
  e_type.value = d.type || "";
  e_owner.value = d.owner || "";
  e_phone.value = d.phone || "";
  e_medical.value = d.medical || "";
}

/* SAVE DATA */
async function save(){
  await db.collection("pets").doc(petId).set({
    name: e_name.value,
    type: e_type.value,
    owner: e_owner.value,
    phone: e_phone.value,
    medical: e_medical.value,
    updated: Date.now()
  });
  alert("Saved successfully");
  closeEdit();
  load();
}

/* UI HELPERS */
function openEdit(){
  view.classList.add("hidden");
  edit.classList.remove("hidden");
}
function closeEdit(){
  edit.classList.add("hidden");
  view.classList.remove("hidden");
}
function callOwner(){
  if(v_phone.innerText)
    location.href = "tel:" + v_phone.innerText;
}

/* START */
load();
</script>

</body>
</html>
